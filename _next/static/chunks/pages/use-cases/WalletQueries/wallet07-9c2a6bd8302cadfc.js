(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[466],{9121:function(e,s,o){(window.__NEXT_P=window.__NEXT_P||[]).push(["/use-cases/WalletQueries/wallet07",function(){return o(5146)}])},5146:function(e,s,o){"use strict";o.r(s),o.d(s,{__toc:function(){return c}});var l=o(5893),n=o(2673),i=o(2169),r=o(2069);o(9488);var t=o(2643),a=o(2154);let c=[{depth:2,value:"7. Query Active Stake Pools",id:"7-query-active-stake-pools"},{depth:3,value:"Select Specific Columns",id:"select-specific-columns"},{depth:3,value:"Tables Involved",id:"tables-involved"},{depth:3,value:"Joins and Subqueries",id:"joins-and-subqueries"},{depth:3,value:"SELECT Clause Details:",id:"select-clause-details"}];function d(e){let s=Object.assign({h2:"h2",p:"p",a:"a",pre:"pre",code:"code",span:"span",details:"details",summary:"summary",h3:"h3",ul:"ul",li:"li",strong:"strong"},(0,t.a)(),e.components);return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(s.h2,{id:"7-query-active-stake-pools",children:"7. Query Active Stake Pools"}),"\n",(0,l.jsxs)(s.p,{children:[(0,l.jsx)(s.a,{href:"https://cardano.org/stake-pool-delegation/",children:"Staking"})," is a big part of the Cardano ecosystem. To get started, the first step is to identify the active stake pools. Our next SQL query retrieves information about active Cardano staking pools, retrievign the pool's ID, name and creation date."]}),"\n",(0,l.jsx)(a.UW,{type:"info",emoji:"\uD83D\uDCA1",children:(0,l.jsxs)(s.p,{children:[(0,l.jsx)(s.a,{href:"https://cardanoscan.io/pools",children:"Cardanoscan"})," shows active stake pools by default. There is a toggle button to 'Show Inactive Pools' \uD83D\uDD0E"]})}),"\n",(0,l.jsx)(s.pre,{"data-language":"sql","data-theme":"default",children:(0,l.jsxs)(s.code,{"data-language":"sql","data-theme":"default",children:[(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"select"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" ph.id ,"})]}),"\n",(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"		"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"COALESCE"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"(po.pool_name, ph."}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"view"'}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:") "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"as"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" pool_name,"})]}),"\n",(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"		po.ticker_name "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"as"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" pool_ticker,"})]}),"\n",(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"		b."}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"time"'}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"AS"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" creation_date,"})]}),"\n",(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"		"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"ROW_NUMBER"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"() "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"OVER"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" ("}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"ORDER BY"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" ph.id "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"ASC"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:") "})]}),"\n",(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"	"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"FROM"})]}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"		pool_hash ph"})}),"\n",(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"	"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"LEFT JOIN"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" pool_offline_data po "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"on"})]}),"\n",(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"		ph.id "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" po.pool_id"})]}),"\n",(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"		"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"and"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" (po.id "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"is"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"null"})]}),"\n",(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"			"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"or"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" po.id "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" ("}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"SELECT"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"max"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"(po2.id)"})]}),"\n",(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"						"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"FROM"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" pool_offline_data po2"})]}),"\n",(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"						"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"WHERE"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" po2.pool_id "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" ph.id))"})]}),"\n",(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"	"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"LEFT JOIN"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" pool_update pu "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"on"})]}),"\n",(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"		ph.id "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" pu.hash_id"})]}),"\n",(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"		"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"and"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" pu.id "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" ("}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"SELECT"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"	"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"min"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"(pu2.id)"})]}),"\n",(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"						"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"FROM"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" pool_update pu2"})]}),"\n",(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"						"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"WHERE"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" pu2.hash_id "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" ph.id)"})]}),"\n",(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"	"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"LEFT JOIN"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" tx "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"ON"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" tx.id "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" pu.registered_tx_id "})]}),"\n",(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"	"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"LEFT JOIN"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"block"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" b "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"ON"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" tx.block_id "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" b.id "})]}),"\n",(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"	"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"WHERE"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" ph.id "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"NOT"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"IN"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" ("}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"SELECT"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" pr.hash_id"})]}),"\n",(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"				        "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"FROM"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" pool_retire pr"})]}),"\n",(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"				        "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"LEFT JOIN"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" pool_update pu "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"on"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"	pr.hash_id "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" pu.hash_id"})]}),"\n",(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"				        "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"LEFT JOIN"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" pool_hash ph "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"ON"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" ph.id "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" pr.hash_id"})]}),"\n",(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"				        "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"GROUP BY"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" pr.hash_id, pu.cert_index, pr.cert_index"})]}),"\n",(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"				        "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"HAVING"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" ("}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"max"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"(pu.registered_tx_id) "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"<"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"max"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"(pr.announced_tx_id))"})]}),"\n",(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"				        	"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"OR"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" (("}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"max"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"(pu.registered_tx_id) "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"max"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"(pr.announced_tx_id)) "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"AND"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" ("}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"max"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"(pu.cert_index) "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"<"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"max"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"(pr.cert_index)))"})]}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"						) "})})]})}),"\n",(0,l.jsxs)(s.details,{children:[(0,l.jsx)(s.summary,{children:(0,l.jsx)(s.p,{children:"Expected results format"})}),(0,l.jsx)(s.pre,{"data-language":"sql","data-theme":"default",children:(0,l.jsxs)(s.code,{"data-language":"sql","data-theme":"default",children:[(0,l.jsx)(s.span,{className:"line",children:" "}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"     id   |      pool_name	      	  |  pool_ticker |      creation_date "})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"----------+---------------------------+--------------+-------------------------- "})}),"\n",(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"     "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"4"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    |      ANGEL stake "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"pool"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"     |     ANGEL    |  "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"2022"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"-"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"10"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"-"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"20"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"21"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:":"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"21"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:":"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"59"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"."}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"000"})]}),"\n",(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"	 "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"5"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    |      CanadaStakes	      |     CAN1     |  "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"2022"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"-"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"10"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"-"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"20"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"21"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:":"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"30"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:":"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"58"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"."}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"000"})]}),"\n",(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"	 "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"6"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"	  |     SION stake "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"pool"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"	      |     SION     |  "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"2022"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"-"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"10"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"-"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"20"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"21"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:":"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"35"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:":"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"52"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"."}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"000"})]}),"\n",(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"	 "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"7"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"	  |  PANL Stake "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"Pool"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"(Pre"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"-"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"Prod)|	    PANL	 |  "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"2022"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"-"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"10"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"-"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"20"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"22"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:":"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"24"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:":"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"32"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"."}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"000"})]}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"     .    |      ................     |     .....    |  ................."})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"           "})}),"\n",(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"(Note: full results trimmed "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"for"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" readability)"})]})]})})]}),"\n",(0,l.jsx)(s.p,{children:"\uD83D\uDD0E Here's a breakdown of how the query works:"}),"\n",(0,l.jsxs)(a.Rg,{children:[(0,l.jsx)(s.h3,{id:"select-specific-columns",children:"Select Specific Columns"}),(0,l.jsx)(s.p,{children:"In order to gather information about staking pools, the query focuses on:"}),(0,l.jsxs)(s.ul,{children:["\n",(0,l.jsxs)(s.li,{children:["Pool ID ",(0,l.jsx)(s.code,{children:"ph.id"}),", the unique identifier for each staking pool"]}),"\n",(0,l.jsxs)(s.li,{children:["Pool Name ",(0,l.jsx)(s.code,{children:"pool_name"}),", the human-readable name of the pool"]}),"\n",(0,l.jsxs)(s.li,{children:["Ticker ",(0,l.jsx)(s.code,{children:"pool_ticker"}),", an abbreviation of the pool"]}),"\n",(0,l.jsxs)(s.li,{children:[(0,l.jsx)(s.code,{children:"creation_date"}),", the date the pool was created"]}),"\n"]}),(0,l.jsx)(s.h3,{id:"tables-involved",children:"Tables Involved"}),(0,l.jsx)(s.p,{children:"The query traverses several tables (aliases are in brackets):"}),(0,l.jsxs)(s.ul,{children:["\n",(0,l.jsxs)(s.li,{children:[(0,l.jsx)(s.a,{href:"https://github.com/cardano-foundation/cf-ledger-sync/blob/main/docs/pages/schema.md#pool_hash",children:"pool_hash"})," (ph) stores the unique hash identifiers for each pool."]}),"\n",(0,l.jsxs)(s.li,{children:[(0,l.jsx)(s.a,{href:"https://github.com/cardano-foundation/cf-ledger-sync/blob/main/docs/pages/schema.md#pool_offline_data",children:"pool_offline_data"})," (po) contains additional information about the pool, such as its name and ticker."]}),"\n",(0,l.jsxs)(s.li,{children:[(0,l.jsx)(s.a,{href:"https://github.com/cardano-foundation/cf-ledger-sync/blob/main/docs/pages/schema.md#pool_update",children:"pool_update"})," (pu) tracks updates or changes made to stake pools. It's joined to find the initial registration transaction of a pool ",(0,l.jsx)(s.code,{children:"pu.registered_tx_id"}),"."]}),"\n",(0,l.jsxs)(s.li,{children:[(0,l.jsx)(s.a,{href:"https://github.com/cardano-foundation/cf-ledger-sync/blob/main/docs/pages/schema.md#tx",children:"tx"})," stores transaction data."]}),"\n",(0,l.jsxs)(s.li,{children:[(0,l.jsx)(s.a,{href:"https://github.com/cardano-foundation/cf-ledger-sync/blob/main/docs/pages/schema.md#block",children:"block"})," (b) stores information about blocks, including their timestamps ",(0,l.jsx)(s.code,{children:"b.time"}),", which are used to determine the pool's creation date."]}),"\n",(0,l.jsxs)(s.li,{children:[(0,l.jsx)(s.a,{href:"https://github.com/cardano-foundation/cf-ledger-sync/blob/main/docs/pages/schema.md#pool_retire",children:"pool_retire"})," (pr) holds information about stake pools that have been retired or de-registered."]}),"\n"]}),(0,l.jsx)(s.h3,{id:"joins-and-subqueries",children:"Joins and Subqueries"}),(0,l.jsx)(s.p,{children:(0,l.jsx)(s.code,{children:"LEFT JOIN pool_offline_data po on ..."})}),(0,l.jsxs)(s.ul,{children:["\n",(0,l.jsxs)(s.li,{children:["Joins ",(0,l.jsx)(s.a,{href:"https://github.com/cardano-foundation/cf-ledger-sync/blob/main/docs/pages/schema.md#pool_hash",children:"pool_hash"})," with ",(0,l.jsx)(s.a,{href:"https://github.com/cardano-foundation/cf-ledger-sync/blob/main/docs/pages/schema.md#pool_offline_data",children:"pool_offline_data"})," to get the pool name and ticker."]}),"\n",(0,l.jsxs)(s.li,{children:["The complex ",(0,l.jsx)(s.code,{children:"ON"})," condition ensures that for each pool hash:","\n",(0,l.jsxs)(s.ul,{children:["\n",(0,l.jsxs)(s.li,{children:["a) the most recent ",(0,l.jsx)(s.a,{href:"https://github.com/cardano-foundation/cf-ledger-sync/blob/main/docs/pages/schema.md#pool_offline_data",children:"pool_offline_data"})," entry if any exists, b)"]}),"\n",(0,l.jsxs)(s.li,{children:["b) If no ",(0,l.jsx)(s.a,{href:"https://github.com/cardano-foundation/cf-ledger-sync/blob/main/docs/pages/schema.md#pool_offline_data",children:"pool_offline_data"})," exists for the pool, we still include the pool in the results (due to the ",(0,l.jsx)(s.code,{children:"LEFT JOIN"}),")."]}),"\n"]}),"\n"]}),"\n"]}),(0,l.jsxs)(s.p,{children:[(0,l.jsx)(s.code,{children:"LEFT JOIN pool_update pu on ..."})," joins ",(0,l.jsx)(s.a,{href:"https://github.com/cardano-foundation/cf-ledger-sync/blob/main/docs/pages/schema.md#pool_hash",children:"pool_hash"})," with ",(0,l.jsx)(s.a,{href:"https://github.com/cardano-foundation/cf-ledger-sync/blob/main/docs/pages/schema.md#pool_update",children:"pool_update"})," to get the earliest registration transaction for each pool using a subquery to find the ",(0,l.jsx)(s.code,{children:"minimum pu.id"})," for each ",(0,l.jsx)(s.code,{children:"pu.hash_id"}),"."]}),(0,l.jsxs)(s.p,{children:[(0,l.jsx)(s.code,{children:"LEFT JOIN tx ON tx.id = pu.registered_tx_id"})," joins the ",(0,l.jsx)(s.a,{href:"https://github.com/cardano-foundation/cf-ledger-sync/blob/main/docs/pages/schema.md#pool_update",children:"pool_update"})," with the tx table to get the transaction associated with the pool's registration."]}),(0,l.jsxs)(s.p,{children:[(0,l.jsx)(s.code,{children:"LEFT JOIN block b ON tx.block_id = b.id"})," joins the tx table with the ",(0,l.jsx)(s.a,{href:"https://github.com/cardano-foundation/cf-ledger-sync/blob/main/docs/pages/schema.md#block",children:"block"})," table to get the block in which the registration transaction was included, allowing us to retrieve the creation date."]}),(0,l.jsxs)(s.p,{children:[(0,l.jsx)(s.code,{children:"WHERE ph.id NOT IN (SELECT ...)"})," is important for filtering out retired stake pools. The subquery identifies retired pools by comparing the registration and retirement transactions and their certificate indices within those transactions. It ensures that only active pools are included in the final result"]}),(0,l.jsxs)(s.h3,{id:"select-clause-details",children:[(0,l.jsx)(s.code,{children:"SELECT"})," Clause Details:"]}),(0,l.jsxs)(s.p,{children:[(0,l.jsx)(s.code,{children:'COALESCE(po.pool_name, ph."view") as pool_name'})," uses ",(0,l.jsx)(s.code,{children:"COALESCE"})," to prioritize the ",(0,l.jsx)(s.code,{children:"pool_name"})," from ",(0,l.jsx)(s.a,{href:"https://github.com/cardano-foundation/cf-ledger-sync/blob/main/docs/pages/schema.md#pool_offline_data",children:"pool_offline_data"}),". If it's null, it falls back to the view from ",(0,l.jsx)(s.a,{href:"https://github.com/cardano-foundation/cf-ledger-sync/blob/main/docs/pages/schema.md#pool_hash",children:"pool_hash"}),". This ensures we have a name for each pool."]}),(0,l.jsxs)(s.p,{children:[(0,l.jsx)(s.code,{children:'b."time" AS creation_date'})," retrieves the time from the ",(0,l.jsx)(s.a,{href:"https://github.com/cardano-foundation/cf-ledger-sync/blob/main/docs/pages/schema.md#block",children:"block"})," table (associated with the pool's registration transaction) and labels it as ",(0,l.jsx)(s.code,{children:"creation_date"}),"."]}),(0,l.jsxs)(s.p,{children:[(0,l.jsx)(s.code,{children:"ROW_NUMBER() OVER (ORDER BY ph.id ASC)"})," assigns a sequential row number to each result row, ordered by the pool hash ID in ascending order. This can be useful for pagination or displaying results in a numbered list."]})]}),"\n",(0,l.jsxs)(s.p,{children:["The ",(0,l.jsx)(s.strong,{children:"next query"})," will provide users with detailed information about specific stake pools. This will help them make informed decisions when selecting a specific pool to delegate their ADA."]})]})}let h={MDXContent:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:s}=Object.assign({},(0,t.a)(),e.components);return s?(0,l.jsx)(s,{...e,children:(0,l.jsx)(d,{...e})}):d(e)},pageOpts:{filePath:"pages/use-cases/WalletQueries/wallet07.mdx",route:"/use-cases/WalletQueries/wallet07",timestamp:1729499085e3,pageMap:[{kind:"Meta",data:{index:"Overview",design:"Design",docker:"Run with Docker Compose",schema:"Schema",build_run:"Build & Run",live_n2c_data:"Live data from Node",applications:{title:"Applications"},"use-cases":{title:"Use Cases"},about:{title:"About",type:"page"}}},{kind:"MdxPage",name:"about",route:"/about"},{kind:"Folder",name:"applications",route:"/applications",children:[{kind:"Meta",data:{ledger_sync_app:"Ledger Sync",streamer_app:"Ledger Sync Streamer"}},{kind:"MdxPage",name:"ledger_sync_app",route:"/applications/ledger_sync_app"},{kind:"MdxPage",name:"streamer_app",route:"/applications/streamer_app"}]},{kind:"MdxPage",name:"build_run",route:"/build_run"},{kind:"MdxPage",name:"design",route:"/design"},{kind:"MdxPage",name:"docker",route:"/docker"},{kind:"MdxPage",name:"index",route:"/"},{kind:"MdxPage",name:"live_n2c_data",route:"/live_n2c_data"},{kind:"MdxPage",name:"schema",route:"/schema"},{kind:"Folder",name:"use-cases",route:"/use-cases",children:[{kind:"Folder",name:"WalletQueries",route:"/use-cases/WalletQueries",children:[{kind:"Meta",data:{wallet01:"Find the ADA balance of a wallet",wallet02:"List a balance's UTXOs",wallet03:"Review wallet transaction history",wallet04:"List all tokens in a wallet",wallet05:"Query collection details",wallet06:"Query Token metadata",wallet07:"Query Active Stake Pools",wallet08:"Query Stake Pool details",wallet09:"Stake pool lifetime blocks",wallet10:"List current dReps",wallet11:"Find Active Governance Proposals",wallet12:"Smart contract transaction data"}},{kind:"MdxPage",name:"wallet01",route:"/use-cases/WalletQueries/wallet01"},{kind:"MdxPage",name:"wallet02",route:"/use-cases/WalletQueries/wallet02"},{kind:"MdxPage",name:"wallet03",route:"/use-cases/WalletQueries/wallet03"},{kind:"MdxPage",name:"wallet04",route:"/use-cases/WalletQueries/wallet04"},{kind:"MdxPage",name:"wallet05",route:"/use-cases/WalletQueries/wallet05"},{kind:"MdxPage",name:"wallet06",route:"/use-cases/WalletQueries/wallet06"},{kind:"MdxPage",name:"wallet07",route:"/use-cases/WalletQueries/wallet07"},{kind:"MdxPage",name:"wallet08",route:"/use-cases/WalletQueries/wallet08"},{kind:"MdxPage",name:"wallet09",route:"/use-cases/WalletQueries/wallet09"},{kind:"MdxPage",name:"wallet10",route:"/use-cases/WalletQueries/wallet10"},{kind:"MdxPage",name:"wallet11",route:"/use-cases/WalletQueries/wallet11"},{kind:"MdxPage",name:"wallet12",route:"/use-cases/WalletQueries/wallet12"}]},{kind:"MdxPage",name:"WalletQueries",route:"/use-cases/WalletQueries"},{kind:"Meta",data:{WalletQueries:"Wallet queries",nftqueries:"NFT marketplace"}},{kind:"Folder",name:"nftqueries",route:"/use-cases/nftqueries",children:[{kind:"Meta",data:{nft1:"View Collections",nft2:"View NFT collection details",nft3:"View all assets",nft4:"Minting an NFT",nft5:"Selling an NFT",nft6:"Buying an NFT"}},{kind:"MdxPage",name:"nft1",route:"/use-cases/nftqueries/nft1"},{kind:"MdxPage",name:"nft2",route:"/use-cases/nftqueries/nft2"},{kind:"MdxPage",name:"nft3",route:"/use-cases/nftqueries/nft3"},{kind:"MdxPage",name:"nft4",route:"/use-cases/nftqueries/nft4"},{kind:"MdxPage",name:"nft5",route:"/use-cases/nftqueries/nft5"},{kind:"MdxPage",name:"nft6",route:"/use-cases/nftqueries/nft6"}]},{kind:"MdxPage",name:"nftqueries",route:"/use-cases/nftqueries"}]},{kind:"MdxPage",name:"use-cases",route:"/use-cases"}],flexsearch:{codeblocks:!0},title:"Wallet07",headings:c},pageNextRoute:"/use-cases/WalletQueries/wallet07",nextraLayout:i.ZP,themeConfig:r.Z};s.default=(0,n.j)(h)},2069:function(e,s,o){"use strict";var l=o(5893);o(7294);let n={logo:(0,l.jsx)("span",{children:(0,l.jsx)("b",{children:"Ledger Sync"})}),project:{link:"https://github.com/cardano-foundation/cf-ledger-sync"},chat:{link:"https://discord.gg/jw3yeYJw"},docsRepositoryBase:"https://github.com/cardano-foundation/cf-ledger-sync",footer:{text:"Ledger Sync project"},useNextSeoProps:()=>({titleTemplate:"%s – Ledger Sync"}),head:(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("meta",{property:"description",content:"Ledger Sync is a Java-based application designed to provide efficient access to Cardano blockchain data"}),(0,l.jsx)("meta",{property:"og:title",content:"Ledger Sync is a Java-based application designed to provide efficient access to Cardano blockchain data"}),(0,l.jsx)("meta",{property:"og:description",content:"Ledger Sync is a Java-based application designed to provide efficient access to Cardano blockchain data"})]})};s.Z=n},5789:function(){}},function(e){e.O(0,[942,888,774,179],function(){return e(e.s=9121)}),_N_E=e.O()}]);