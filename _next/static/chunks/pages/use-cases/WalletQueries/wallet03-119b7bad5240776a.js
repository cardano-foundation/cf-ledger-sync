(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[141],{9728:function(s,e,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/use-cases/WalletQueries/wallet03",function(){return r(9263)}])},9263:function(s,e,r){"use strict";r.r(e),r.d(e,{__toc:function(){return c}});var l=r(5893),o=r(2673),n=r(2169),t=r(2069);r(9488);var i=r(2643),a=r(2154);let c=[{depth:2,value:"3. Review wallet transaction history",id:"3-review-wallet-transaction-history"},{depth:3,value:"3.1 Transaction details",id:"31-transaction-details"},{depth:3,value:"First Part (Before UNION)",id:"first-part-before-union"},{depth:3,value:"Second Part (After UNION)",id:"second-part-after-union"},{depth:3,value:"3.2 Retrieve Transaction signatories",id:"32-retrieve-transaction-signatories"},{depth:3,value:"3.3 Retrieve Native Asset details",id:"33-retrieve-native-asset-details"},{depth:3,value:"Two Subqueries Combined with UNION ALL",id:"two-subqueries-combined-with-union-all"},{depth:3,value:"First Subquery focuses on Outputs",id:"first-subquery-focuses-on-outputs"},{depth:3,value:"Second Subquery focuses on Inputs",id:"second-subquery-focuses-on-inputs"},{depth:3,value:"Main Query",id:"main-query"},{depth:3,value:"Summary",id:"summary"}];function h(s){let e=Object.assign({h2:"h2",p:"p",code:"code",a:"a",h3:"h3",ul:"ul",li:"li",pre:"pre",span:"span",details:"details",summary:"summary",em:"em",br:"br"},(0,i.a)(),s.components);return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(e.h2,{id:"3-review-wallet-transaction-history",children:"3. Review wallet transaction history"}),"\n",(0,l.jsxs)(e.p,{children:["For consistency, we will query the same preprod address as before:\n",(0,l.jsx)(e.code,{children:"addr_test1qr70pedl22tnzswcfm39nqvsfan9jgtym2k0lgrftga8j67jel8q0vyag8770e8pu3rf6he70dtrexrsg6waj09cae0svmt57t"})]}),"\n",(0,l.jsxs)(e.p,{children:["\uD83D\uDD0E You can verify results using any of the community explorers listed ",(0,l.jsx)(e.a,{href:"https://explorer.cardano.org/en/",children:"here"}),"."]}),"\n",(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.a,{href:"https://preprod.cardanoscan.io/address/00fcf0e5bf52973141d84ee25981904f66592164daacffa0695a3a796bd2cfce07b09d41fde7e4e1e4469d5f3e7b563c9870469dd93cb8ee5f",children:"CardanoScan search"})," (remember to choose 'Preprod' in the top right)"]}),"\n",(0,l.jsx)(e.p,{children:"We will break the query up into three parts to fetch the information we need for the overall query."}),"\n",(0,l.jsx)(e.h3,{id:"31-transaction-details",children:"3.1 Transaction details"}),"\n",(0,l.jsx)(e.p,{children:"First, let's determine which transaction details we want to collect:"}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsx)(e.li,{children:"amount of ADA transferred"}),"\n",(0,l.jsx)(e.li,{children:"if the transaction is incoming/outgoing"}),"\n",(0,l.jsx)(e.li,{children:"transaction fee"}),"\n",(0,l.jsx)(e.li,{children:"assets (name and quantity)"}),"\n",(0,l.jsx)(e.li,{children:"transaction hash"}),"\n",(0,l.jsx)(e.li,{children:"Timestamp"}),"\n",(0,l.jsx)(e.li,{children:"Slot/Block"}),"\n"]}),"\n",(0,l.jsx)(e.pre,{"data-language":"sql","data-theme":"default",children:(0,l.jsxs)(e.code,{"data-language":"sql","data-theme":"default",children:[(0,l.jsx)(e.span,{className:"line",children:(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"-- Transactions where the address is the output"})}),"\n",(0,l.jsx)(e.span,{className:"line",children:(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"SELECT"})}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"	"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"COALESCE"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"sum"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"(tx_out.value), "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"0"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:") "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"-"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"COALESCE"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"(inp.inp_value, "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"0"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:") "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"AS"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" ADA_amount,"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"	"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'outgoing'"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"AS"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" direction,"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"	tx.fee "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"AS"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" fee,"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"	tx.hash "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"AS"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" tx_hash,"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"	"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"block"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"."}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"time"'}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"AS"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" time_stamp,"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"	block.block_no "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"AS"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"block"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:","})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"	block.slot_no "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"AS"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" slot"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"FROM"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" tx_out"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"JOIN"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" tx "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"ON"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" tx.id "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" tx_out.tx_id"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"LEFT JOIN"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" ( "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"SELECT"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"		tx.id "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"AS"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" inp_txid,"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"		tx.hash "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"AS"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" inp_hash,"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"		tx_out.address "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"AS"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" source_add,"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"		"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"sum"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"(tx_out.value) "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"AS"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" inp_value"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"           "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"FROM"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" tx_in"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"	   "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"JOIN"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" tx_out "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"ON"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" tx_out.tx_id "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" tx_in.tx_out_id"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"		    "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"AND"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" tx_out.index "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" tx_in.tx_out_index"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    	   "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"JOIN"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" tx "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"ON"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" tx.id "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" tx_in.tx_in_id"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"	   "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"WHERE"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"		tx_out.address "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'addr_test1qr70pedl22tnzswcfm39nqvsfan9jgtym2k0lgrftga8j67jel8q0vyag8770e8pu3rf6he70dtrexrsg6waj09cae0svmt57t'"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"           "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"GROUP BY"})]}),"\n",(0,l.jsx)(e.span,{className:"line",children:(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"		inp_txid,"})}),"\n",(0,l.jsx)(e.span,{className:"line",children:(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"		inp_hash,"})}),"\n",(0,l.jsx)(e.span,{className:"line",children:(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"		source_add"})}),"\n",(0,l.jsx)(e.span,{className:"line",children:(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    		) "})}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    	"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"AS"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" inp "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"ON"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" inp.inp_txid "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" tx.id"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"JOIN"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"block"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"ON"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" block.id "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" tx.block_id"})]}),"\n",(0,l.jsx)(e.span,{className:"line",children:(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"WHERE"})}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"	tx_out.address "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'addr_test1qr70pedl22tnzswcfm39nqvsfan9jgtym2k0lgrftga8j67jel8q0vyag8770e8pu3rf6he70dtrexrsg6waj09cae0svmt57t'"})]}),"\n",(0,l.jsx)(e.span,{className:"line",children:(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"GROUP BY"})}),"\n",(0,l.jsx)(e.span,{className:"line",children:(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"	tx_hash,"})}),"\n",(0,l.jsx)(e.span,{className:"line",children:(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"	direction,"})}),"\n",(0,l.jsx)(e.span,{className:"line",children:(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"	fee,"})}),"\n",(0,l.jsx)(e.span,{className:"line",children:(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"	time_stamp,"})}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"	"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"block"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:","})]}),"\n",(0,l.jsx)(e.span,{className:"line",children:(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"	slot,"})}),"\n",(0,l.jsx)(e.span,{className:"line",children:(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"	inp.inp_value"})}),"\n",(0,l.jsx)(e.span,{className:"line",children:" "}),"\n",(0,l.jsx)(e.span,{className:"line",children:" "}),"\n",(0,l.jsx)(e.span,{className:"line",children:(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"UNION"})}),"\n",(0,l.jsx)(e.span,{className:"line",children:" "}),"\n",(0,l.jsx)(e.span,{className:"line",children:" "}),"\n",(0,l.jsx)(e.span,{className:"line",children:(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"-- Transactions where the address is the output and not an output"})}),"\n",(0,l.jsx)(e.span,{className:"line",children:(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"SELECT"})}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"sum"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"(tx_out.value) "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"AS"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" ADA_amount,"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"	"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'incoming'"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"AS"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" direction,"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"	tx.fee "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"AS"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" fee,"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"	tx.hash "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"AS"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" tx_hash,"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"	"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"block"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"."}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"time"'}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"AS"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" time_stamp,"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"	block.block_no "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"AS"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"block"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:","})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"	block.slot_no "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"AS"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" slot"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"FROM"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" tx_in"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"JOIN"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" tx_out "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"ON"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" tx_out.tx_id "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" tx_in.tx_out_id"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"			"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"AND"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" tx_out.index "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" tx_in.tx_out_index"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"JOIN"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" tx "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"ON"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" tx.id "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" tx_in.tx_in_id"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"JOIN"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"block"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"ON"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" block.id "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" tx.block_id"})]}),"\n",(0,l.jsx)(e.span,{className:"line",children:(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"WHERE"})}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"	tx_out.address "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'addr_test1qr70pedl22tnzswcfm39nqvsfan9jgtym2k0lgrftga8j67jel8q0vyag8770e8pu3rf6he70dtrexrsg6waj09cae0svmt57t'"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"	"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"AND"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"NOT"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"EXISTS"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" ("}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"SELECT"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"1"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"AS"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" txid"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"					"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"FROM"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" tx_out"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"					"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"WHERE"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"						tx_out.address "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'addr_test1qr70pedl22tnzswcfm39nqvsfan9jgtym2k0lgrftga8j67jel8q0vyag8770e8pu3rf6he70dtrexrsg6waj09cae0svmt57t'"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"						"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"AND"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" tx_out.tx_id "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" tx.id )"})]}),"\n",(0,l.jsx)(e.span,{className:"line",children:(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"GROUP BY"})}),"\n",(0,l.jsx)(e.span,{className:"line",children:(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"	tx_hash,"})}),"\n",(0,l.jsx)(e.span,{className:"line",children:(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"	direction,"})}),"\n",(0,l.jsx)(e.span,{className:"line",children:(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"	fee,"})}),"\n",(0,l.jsx)(e.span,{className:"line",children:(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"	time_stamp,"})}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"	"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"block"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:","})]}),"\n",(0,l.jsx)(e.span,{className:"line",children:(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"	slot"})})]})}),"\n",(0,l.jsxs)(e.details,{children:[(0,l.jsx)(e.summary,{children:(0,l.jsx)(e.p,{children:"Expected results format"})}),(0,l.jsx)(e.pre,{"data-language":"sql","data-theme":"default",children:(0,l.jsxs)(e.code,{"data-language":"sql","data-theme":"default",children:[(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"     ada_amount	  | direction |  fee    |                         tx_hash                                  |      time_stamp       |   "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"block"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"   |  slot"})]}),"\n",(0,l.jsx)(e.span,{className:"line",children:(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"------------------+-----------+---------+------------------------------------------------------------------+-----------------------+-----------+------------"})}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"2"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:","}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"000"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:","}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"000"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:","}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"000"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:","}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"000"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" | outgoing  | "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"174"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:","}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"961"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" | 17abe1200ebe4b801d830f8c216a421dcff778ed82b1f83198acd403b2938384 | "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"2024"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"-"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"02"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"-"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"05"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"20"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:":"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"13"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:":"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"48"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"."}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"00"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"| "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"1"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:","}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"899"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:","}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"032"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" |  "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"51"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:","}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"480"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:","}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"828"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"-"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"199"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:","}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"601"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"      | outgoing  | "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"199"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:","}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"601"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"	|  8eb504479c678b0a1d0073b3420f0b62df9ca98b7e503005f157580c010e1d0f| "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"2023"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"-"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"07"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"-"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"10"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"02"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:":"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"37"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:":"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"30"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"."}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"00"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"| "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"1"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:","}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"143"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:","}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"600"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" |  "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"33"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:","}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"273"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:","}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"450"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"39"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:","}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"735"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:","}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"569"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:","}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"942"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"	  | outgoing  | "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"177"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:","}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"469"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" |  8ffaafe1dde6f78d6b742d94c9f1a21c892389d9fa73861211356687b751cf66| "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"2023"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"-"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"12"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"-"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"12"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"04"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:":"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"39"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:":"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"20"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"."}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"00"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"| "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"1"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:","}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"692"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:","}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"918"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" |  "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"46"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:","}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"672"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:","}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"760"})]}),"\n",(0,l.jsx)(e.span,{className:"line",children:(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"             "})}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"(Note: results trimmed "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"for"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" readability)"})]})]})})]}),"\n",(0,l.jsx)(e.p,{children:"The overall aim is to track the flow of ADA for our specific address. It categorizes transactions as 'outgoing' or 'incoming' and provides details like the amount, fee, timestamp, and block information."}),"\n",(0,l.jsx)(a.UW,{type:"info",emoji:"\uD83D\uDCA1",children:(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsx)(e.li,{children:'When we say "outgoing", this is the address that is in the output of that transaction, and possibly the input as well (if they are receiving any change back).'}),"\n",(0,l.jsx)(e.li,{children:'When we say "incoming", this is the address in the input part of that transaction, and not in the output part.'}),"\n"]})}),"\n",(0,l.jsx)(e.p,{children:"\uD83D\uDD0E Let's take a closer look at each part of the query."}),"\n",(0,l.jsxs)(a.Rg,{children:[(0,l.jsx)(e.h3,{id:"first-part-before-union",children:"First Part (Before UNION)"}),(0,l.jsx)(e.p,{children:(0,l.jsx)(e.code,{children:"SELECT COALESCE(sum(tx_out.value), 0) - COALESCE(inp.inp_value, 0) AS ADA_amount, 'outgoing' AS direction, ..."})}),(0,l.jsxs)(e.p,{children:["This SELECT statement calculates the net ADA amount involved in transactions where the given address is an output, ie. recipient.\n",(0,l.jsx)(e.code,{children:"COALESCE"})," ensures that if ",(0,l.jsx)(e.code,{children:"sum(tx_out.value)"})," or ",(0,l.jsx)(e.code,{children:"inp.inp_value"})," is NULL, they are treated as 0, preventing errors.\n",(0,l.jsx)(e.code,{children:"outgoing"})," labels these transactions as outgoing."]}),(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.code,{children:"FROM tx_out JOIN tx ON tx.id = tx_out.tx_id ..."}),"\nThis FROM statement starts by looking at ",(0,l.jsx)(e.a,{href:"https://github.com/cardano-foundation/cf-ledger-sync/blob/main/docs/pages/schema.md#tx_out",children:"tx_out"})," (transaction outputs) and joins it with the ",(0,l.jsx)(e.a,{href:"https://github.com/cardano-foundation/cf-ledger-sync/blob/main/docs/pages/schema.md#tx",children:"tx"}),"\n(transactions) table, linking them based on transaction IDs."]}),(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.code,{children:"LEFT JOIN ( SELECT ... ) AS inp ON inp.inp_txid = tx.id"})," is a subquery aliased as ",(0,l.jsx)(e.code,{children:"inp"}),". It looks for transactions where the given address is an input (or sender) and calculates the total input value ",(0,l.jsx)(e.code,{children:"inp_value"})," for those transactions."]}),(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.code,{children:"LEFT JOIN"})," includes all rows from the left table ",(0,l.jsx)(e.a,{href:"https://github.com/cardano-foundation/cf-ledger-sync/blob/main/docs/pages/schema.md#tx",children:"tx"})," even if there's no match in the subquery ",(0,l.jsx)(e.code,{children:"inp"}),"."]}),(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.code,{children:"JOIN block ON block.id = tx.block_id"})," joins the ",(0,l.jsx)(e.a,{href:"https://github.com/cardano-foundation/cf-ledger-sync/blob/main/docs/pages/schema.md#block",children:"block"})," table to get block-related information (timestamp, block number, slot number)."]}),(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.code,{children:"WHERE tx_out.address = '...'"})," filters results to only include transactions where the specified address is an output."]}),(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.code,{children:"GROUP BY tx_hash, ..."})," groups the results by transaction hash and other fields to avoid duplicate rows."]}),(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.code,{children:"UNION"})," combines the results of the first part with the second part."]}),(0,l.jsx)(e.h3,{id:"second-part-after-union",children:"Second Part (After UNION)"}),(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.code,{children:"SELECT sum(tx_out.value) AS ADA_amount, 'incoming' AS direction, ..."})," calculates the total ADA amount for incoming transactions."]}),(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.code,{children:"incoming"})," labels these transactions as incoming. ",(0,l.jsx)(e.code,{children:"FROM tx_in JOIN tx_out ON ... JOIN tx ON ... JOIN block ON ..."})," similar joins as in the first part, but starts from ",(0,l.jsx)(e.a,{href:"https://github.com/cardano-foundation/cf-ledger-sync/blob/main/docs/pages/schema.md#tx_in",children:"tx_in"})," (transaction inputs)."]}),(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.code,{children:"WHERE tx_out.address = '...' AND NOT EXISTS (SELECT 1 AS txid FROM tx_out WHERE ...)"})," filters to include transactions where:"]}),(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsxs)(e.li,{children:["The address is an input (via ",(0,l.jsx)(e.a,{href:"https://github.com/cardano-foundation/cf-ledger-sync/blob/main/docs/pages/schema.md#tx_out",children:"tx_out"})," linked to ",(0,l.jsx)(e.a,{href:"https://github.com/cardano-foundation/cf-ledger-sync/blob/main/docs/pages/schema.md#tx_in",children:"tx_in"}),")."]}),"\n",(0,l.jsx)(e.li,{children:"The address is not an output in the same transaction (using NOT EXISTS)."}),"\n"]}),(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.code,{children:"GROUP BY tx_hash, ..."})," groups the results similarly to the first part."]})]}),"\n",(0,l.jsx)(e.h3,{id:"32-retrieve-transaction-signatories",children:"3.2 Retrieve Transaction signatories"}),"\n",(0,l.jsx)(e.p,{children:"Next we will run a query to get the transaction signatories. :writing_hand:"}),"\n",(0,l.jsxs)(e.p,{children:["For that, we will be using the transaction hash ",(0,l.jsx)(e.code,{children:"3565bb0621d56ff3349f014a41c7c4c9f5614288a4b00abbe76d3b41becc9da7"})," as it has more than one signer keys."]}),"\n",(0,l.jsx)(e.pre,{"data-language":"sql","data-theme":"default",children:(0,l.jsxs)(e.code,{"data-language":"sql","data-theme":"default",children:[(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"SELECT"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" tw."}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"key"'}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"AS"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" Transaction_Signatories"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"			"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"FROM"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" tx"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"			"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"LEFT JOIN"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" tx_witnesses tw "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"ON"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" tx.id "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" tw.tx_id"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"			"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"WHERE"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" tx.hash "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'3565bb0621d56ff3349f014a41c7c4c9f5614288a4b00abbe76d3b41becc9da7'"})]})]})}),"\n",(0,l.jsxs)(e.details,{children:[(0,l.jsx)(e.summary,{children:(0,l.jsx)(e.p,{children:"Expected results format"})}),(0,l.jsx)(e.pre,{"data-language":"sql","data-theme":"default",children:(0,l.jsxs)(e.code,{"data-language":"sql","data-theme":"default",children:[(0,l.jsx)(e.span,{className:"line",children:(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"     transaction_signatories"})}),"\n",(0,l.jsx)(e.span,{className:"line",children:(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"----------------------------------------------------------------"})}),"\n",(0,l.jsx)(e.span,{className:"line",children:(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"1fdbf347cae52d54a9cf7f58e4ecf461144bbfb38a330dce3e8d66f1391bc442"})}),"\n",(0,l.jsx)(e.span,{className:"line",children:(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"55ff3b5b6603609463566057e0713cb2db512838eb864a0c15d73b377c278ae3"})}),"\n",(0,l.jsx)(e.span,{className:"line",children:" "}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"2"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"rows"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:")"})]})]})})]}),"\n",(0,l.jsx)(e.p,{children:"\uD83D\uDD0E  Let's take a closer look at each part of the query."}),"\n",(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.code,{children:'SELECT tw."key" AS Transaction_Signatories'})," selects the ",(0,l.jsx)(e.code,{children:"key"})," column from the ",(0,l.jsx)(e.a,{href:"https://github.com/cardano-foundation/cf-ledger-sync/blob/main/docs/pages/schema.md#tx_witnesses",children:"tx_witnesses"})," table and renames it as ",(0,l.jsx)(e.code,{children:"Transaction_Signatories"})," in the output."]}),"\n",(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.code,{children:"FROM tx"})," means the query is looking in the ",(0,l.jsx)(e.a,{href:"https://github.com/cardano-foundation/cf-ledger-sync/blob/main/docs/pages/schema.md#tx",children:"tx"})," table."]}),"\n",(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.code,{children:"LEFT JOIN tx_witnesses tw ON tx.id = tw.tx_id"})," performs a LEFT JOIN with the ",(0,l.jsx)(e.a,{href:"https://github.com/cardano-foundation/cf-ledger-sync/blob/main/docs/pages/schema.md#tx_witnesses",children:"tx_witnesses"})," table.\n",(0,l.jsx)(e.code,{children:"LEFT JOIN tx_witnesses tw ON tx.id = tw.tx_id"})," performs a LEFT JOIN with the ",(0,l.jsx)(e.a,{href:"https://github.com/cardano-foundation/cf-ledger-sync/blob/main/docs/pages/schema.md#tx_witnesses",children:"tx_witnesses"})," table."]}),"\n",(0,l.jsxs)(e.p,{children:["The ",(0,l.jsx)(e.code,{children:"JOIN"})," condition ",(0,l.jsx)(e.code,{children:"tx.id = tw.tx_id"})," connects rows from both tables where the ",(0,l.jsx)(e.code,{children:"id"})," in the ",(0,l.jsx)(e.a,{href:"https://github.com/cardano-foundation/cf-ledger-sync/blob/main/docs/pages/schema.md#tx",children:"tx"})," table matches the ",(0,l.jsx)(e.code,{children:"tx_id"})," in the ",(0,l.jsx)(e.a,{href:"https://github.com/cardano-foundation/cf-ledger-sync/blob/main/docs/pages/schema.md#tx_witnesses",children:"tx_witnesses"})," table."]}),"\n",(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.code,{children:"LEFT JOIN"})," ensures that all rows from the ",(0,l.jsx)(e.a,{href:"https://github.com/cardano-foundation/cf-ledger-sync/blob/main/docs/pages/schema.md#tx",children:"tx"})," table are included in the result, even if there's no corresponding match in the ",(0,l.jsx)(e.a,{href:"https://github.com/cardano-foundation/cf-ledger-sync/blob/main/docs/pages/schema.md#tx_witnesses",children:"tx_witnesses"})," table. In such cases, the columns from ",(0,l.jsx)(e.a,{href:"https://github.com/cardano-foundation/cf-ledger-sync/blob/main/docs/pages/schema.md#tx_witnesses",children:"tx_witnesses"})," will have NULL values."]}),"\n",(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.code,{children:"WHERE tx.hash = '3565bb0621d56ff3349f014a41c7c4c9f5614288a4b00abbe76d3b41becc9da7'"})," is a filtering condition restricting the output to only those rows where the hash column in the ",(0,l.jsx)(e.a,{href:"https://github.com/cardano-foundation/cf-ledger-sync/blob/main/docs/pages/schema.md#tx",children:"tx"})," table matches the provided specific hash value."]}),"\n",(0,l.jsx)(e.h3,{id:"33-retrieve-native-asset-details",children:"3.3 Retrieve Native Asset details"}),"\n",(0,l.jsxs)(e.p,{children:["While reviewing the above transactions, you might notice that some include more than just ADA, they also include ",(0,l.jsx)(e.em,{children:(0,l.jsx)(e.a,{href:"https://developers.cardano.org/docs/get-started/cardano-cli/native-assets/",children:"Cardano Native Assets"})}),"."]}),"\n",(0,l.jsxs)(e.p,{children:["Next we will run a query get the details of a specific transaction which includes a native asset. We will use the transaction hash ",(0,l.jsx)(e.code,{children:"3565bb0621d56ff3349f014a41c7c4c9f5614288a4b00abbe76d3b41becc9da7"})," because this transaction has native assets, in addtion to ada."]}),"\n",(0,l.jsx)(e.pre,{"data-language":"sql","data-theme":"default",children:(0,l.jsxs)(e.code,{"data-language":"sql","data-theme":"default",children:[(0,l.jsx)(e.span,{className:"line",children:" "}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"SELECT"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" tx_detail."}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"*"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"FROM"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" (	"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"			"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"SELECT"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"				"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'output'"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"AS"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" direction,"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"				tx_out.address "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"AS"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"address"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:","})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"				sa."}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"view"'}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"AS"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" stake_address,"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"				tx_out.value "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"AS"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" ADA_amount,"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"				ma.name "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"AS"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" asset_name,"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"				"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"sum"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"(mto.quantity) "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"AS"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" quantity,"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"				b.time "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"AS"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" time_stamp,"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"				tx.fee "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"AS"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" transaction_fee,"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"				b.block_no "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"AS"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"block"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:","})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"				b.slot_no "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"AS"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" slot,"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"				"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"NULL"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"AS"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" utxo"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"			"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"FROM"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" tx"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"				"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"LEFT JOIN"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" tx_out "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"ON"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" tx_out.tx_id "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" tx.id"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"				"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"LEFT JOIN"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" stake_address sa "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"ON"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" sa.id "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" tx_out.stake_address_id"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"				"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"LEFT JOIN"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" ma_tx_out mto "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"ON"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" mto.tx_out_id "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" tx_out.id"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"				"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"LEFT JOIN"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" multi_asset ma "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"ON"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" ma.id "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" mto.ident"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"				"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"LEFT JOIN"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"block"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" b "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"ON"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" b.id "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" tx.block_id"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"			"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"WHERE"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"				tx.hash "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'3565bb0621d56ff3349f014a41c7c4c9f5614288a4b00abbe76d3b41becc9da7'"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"			"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"GROUP BY"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" direction, "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"address"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:", stake_address, ADA_amount, asset_name, time_stamp, transaction_fee, "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"block"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:", slot, utxo"})]}),"\n",(0,l.jsx)(e.span,{className:"line",children:(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"				"})}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"			"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"UNION ALL"})]}),"\n",(0,l.jsx)(e.span,{className:"line",children:" "}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"			"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"SELECT"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"				"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'input'"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"AS"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" direction,"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"				tx_out.address "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"AS"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"address"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:","})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"				sa."}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"view"'}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"AS"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" stake_address,"})]}),"\n",(0,l.jsx)(e.span,{className:"line",children:(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"				tx_out.value ADA_amount,"})}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"				ma.name "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"AS"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" asset_name,"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"				"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"sum"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"(mto.quantity) "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"AS"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" quantity,"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"				b.time "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"AS"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" time_stamp,"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"				tx.fee "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"AS"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" transaction_fee,"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"				b.block_no "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"AS"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"block"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:","})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"				b.slot_no "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"AS"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" slot,"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"				txin.hash "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"AS"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" utxo"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"			"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"FROM"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" tx"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"				"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"LEFT JOIN"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" tx_in ti "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"ON"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" ti.tx_in_id "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" tx.id"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"				"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"LEFT JOIN"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" tx_out "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"ON"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" tx_out.tx_id "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" ti.tx_out_id "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"AND"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" tx_out."}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"index"'}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" ti.tx_out_index "})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"				"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"LEFT JOIN"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" tx txin "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"ON"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" txin.id "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" tx_out.tx_id"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"				"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"LEFT JOIN"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" stake_address sa "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"ON"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" sa.id "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" tx_out.stake_address_id"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"				"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"LEFT JOIN"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" ma_tx_out mto "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"ON"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" mto.tx_out_id "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" tx_out.id"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"				"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"LEFT JOIN"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" multi_asset ma "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"ON"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" ma.id "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" mto.ident"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"				"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"LEFT JOIN"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"block"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" b "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"ON"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" b.id "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" tx.block_id"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"			"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"WHERE"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"				tx.hash "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'3565bb0621d56ff3349f014a41c7c4c9f5614288a4b00abbe76d3b41becc9da7'"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"			"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"GROUP BY"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" direction, "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"address"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:", stake_address, ADA_amount, asset_name, time_stamp, transaction_fee, "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"block"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:", slot, utxo"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"				) "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"AS"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" tx_detail"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"ORDER BY"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" tx_detail.direction "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"ASC"})]})]})}),"\n",(0,l.jsxs)(e.details,{children:[(0,l.jsx)(e.summary,{children:(0,l.jsx)(e.p,{children:"Expected results format"})}),(0,l.jsx)(e.pre,{"data-language":"sql","data-theme":"default",children:(0,l.jsxs)(e.code,{"data-language":"sql","data-theme":"default",children:[(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"direction  | "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"address"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" 			  |  stake_addres                    | ada_amount    | asset_name | quantity |  time_stamp  | transaction_fee| "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"block"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"  | slot    |  utxo	"})]}),"\n",(0,l.jsx)(e.span,{className:"line",children:(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"-----------+------------------------------+----------------------------------+---------------+------------+----------+--------------+----------------+--------+---------+---------------"})}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"input      | addr_test1qr...09cae0svmt57t | stake_test1urfvl...8juwuhclq5pxz | "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"4531923278317"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" | tDRIP      | "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"1000020"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"  |  "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"2024"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"-"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"04"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"-"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"03"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"  | "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"196917"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"         | "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"2106415"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"| "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"56425275"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"| a55dca...ff747"})]}),"\n",(0,l.jsx)(e.span,{className:"line",children:(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "})}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"(Note: results trimmed "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"for"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" readability)"})]})]})})]}),"\n",(0,l.jsx)(e.p,{children:"\uD83D\uDD0E  Let's zoom in for a closer look at each part of the query."}),"\n",(0,l.jsxs)(a.Rg,{children:[(0,l.jsx)(e.h3,{id:"two-subqueries-combined-with-union-all",children:"Two Subqueries Combined with UNION ALL"}),(0,l.jsxs)(e.p,{children:["The main query selects everything prefixed ",(0,l.jsx)(e.code,{children:"tx_detail"})," by combining the results of two subqueries using ",(0,l.jsx)(e.code,{children:"UNION ALL"})," which appends the results of the second subquery to the first, without removing duplicates."]}),(0,l.jsx)(e.h3,{id:"first-subquery-focuses-on-outputs",children:"First Subquery focuses on Outputs"}),(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.code,{children:"SELECT 'output' AS direction, ..."})," labels each row as an 'output'.\n",(0,l.jsx)(e.code,{children:"FROM tx LEFT JOIN tx_out ..."})," starts from the ",(0,l.jsx)(e.a,{href:"https://github.com/cardano-foundation/cf-ledger-sync/blob/main/docs/pages/schema.md#tx",children:"tx"})," table and joins with ",(0,l.jsx)(e.a,{href:"https://github.com/cardano-foundation/cf-ledger-sync/blob/main/docs/pages/schema.md#tx_out",children:"tx_out"})," (transaction outputs) table to get output details.\n",(0,l.jsx)(e.code,{children:"LEFT JOIN stake_address ..."})," joins with ",(0,l.jsx)(e.code,{children:"stake_address"})," to get associated stake address information.\n",(0,l.jsx)(e.code,{children:"LEFT JOIN ma_tx_out ... LEFT JOIN multi_asset ..."})," joins to gather details about any native assets involved in the outputs.\n",(0,l.jsx)(e.code,{children:"LEFT JOIN block b ..."})," joins with ",(0,l.jsx)(e.a,{href:"https://github.com/cardano-foundation/cf-ledger-sync/blob/main/docs/pages/schema.md#block",children:"block"})," to get block-related info.",(0,l.jsx)(e.br,{}),"\n",(0,l.jsx)(e.code,{children:"WHERE tx.hash = '...'"})," filters to focus only on the specific transaction.\n",(0,l.jsx)(e.code,{children:"GROUP BY ..."})," groups results to avoid redundancy, especially when multiple native assets are involved in an output.\n",(0,l.jsx)(e.code,{children:"NULL AS utxo"})," sets the utxo column to ",(0,l.jsx)(e.code,{children:"NULL"})," for outputs, as UTXOs are relevant to inputs."]}),(0,l.jsx)(e.h3,{id:"second-subquery-focuses-on-inputs",children:"Second Subquery focuses on Inputs"}),(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.code,{children:"SELECT 'input' AS direction, ..."})," labels each row as an 'input'.\n",(0,l.jsx)(e.code,{children:"FROM tx LEFT JOIN tx_in ..."})," starts from ",(0,l.jsx)(e.a,{href:"https://github.com/cardano-foundation/cf-ledger-sync/blob/main/docs/pages/schema.md#tx",children:"tx"})," table and joins with ",(0,l.jsx)(e.a,{href:"https://github.com/cardano-foundation/cf-ledger-sync/blob/main/docs/pages/schema.md#tx_in",children:"tx_in"})," (transaction inputs) table.\n",(0,l.jsx)(e.code,{children:"LEFT JOIN tx_out ... LEFT JOIN tx txin ..."})," traces back from the input to the original output it's spending, to get details about that output.\nOther joins and ",(0,l.jsx)(e.code,{children:"WHERE"})," clause are similar to the first subquery.\n",(0,l.jsx)(e.code,{children:"txin.hash AS utxo"})," includes the hash of the transaction that created the spent output, representing the UTXO."]}),(0,l.jsx)(e.h3,{id:"main-query",children:"Main Query"}),(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.code,{children:"SELECT tx_detail.* FROM (...) AS tx_detail"})," selects all columns from the combined results of the subqueries.\n",(0,l.jsx)(e.code,{children:"ORDER BY tx_detail.direction ASC"})," orders the results, showing outputs first, then inputs."]}),(0,l.jsx)(e.h3,{id:"summary",children:"Summary"}),(0,l.jsx)(e.p,{children:"This query gives you a detailed breakdown of the inputs and outputs of the Cardano transaction we are interested in."}),(0,l.jsx)(e.p,{children:"Next, we will run a query to fetch a breakdown list of all the native tokens (both fungible tokens and NFTs) held in the wallet. This will provide a detailed view of your various assets, allowing you to see each token or NFT along with its name and quantity."})]})]})}let d={MDXContent:function(){let s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:e}=Object.assign({},(0,i.a)(),s.components);return e?(0,l.jsx)(e,{...s,children:(0,l.jsx)(h,{...s})}):h(s)},pageOpts:{filePath:"pages/use-cases/WalletQueries/wallet03.mdx",route:"/use-cases/WalletQueries/wallet03",timestamp:1726043952e3,pageMap:[{kind:"Meta",data:{index:"Overview",design:"Design",docker:"Run with Docker Compose",schema:"Schema",build_run:"Build & Run",applications:{title:"Applications"},"use-cases":{title:"Use Cases"},about:{title:"About",type:"page"}}},{kind:"MdxPage",name:"about",route:"/about"},{kind:"Folder",name:"applications",route:"/applications",children:[{kind:"Meta",data:{ledger_sync_app:"Ledger Sync",streamer_app:"Ledger Sync Streamer"}},{kind:"MdxPage",name:"ledger_sync_app",route:"/applications/ledger_sync_app"},{kind:"MdxPage",name:"streamer_app",route:"/applications/streamer_app"}]},{kind:"MdxPage",name:"build_run",route:"/build_run"},{kind:"MdxPage",name:"design",route:"/design"},{kind:"MdxPage",name:"docker",route:"/docker"},{kind:"MdxPage",name:"index",route:"/"},{kind:"MdxPage",name:"schema",route:"/schema"},{kind:"Folder",name:"use-cases",route:"/use-cases",children:[{kind:"Folder",name:"WalletQueries",route:"/use-cases/WalletQueries",children:[{kind:"Meta",data:{wallet01:"Find the ADA balance of a wallet",wallet02:"List a balance's UTXOs",wallet03:"Review wallet transaction history",wallet04:"List all tokens in a wallet",wallet05:"Query collection details",wallet06:"Query Token metadata",wallet07:"Query Active Stake Pools",wallet08:"Query Stake Pool details",wallet09:"Stake pool lifetime blocks",wallet10:"List current dReps",wallet11:"Find Active Governance Proposals",wallet12:"Smart contract transaction data"}},{kind:"MdxPage",name:"wallet01",route:"/use-cases/WalletQueries/wallet01"},{kind:"MdxPage",name:"wallet02",route:"/use-cases/WalletQueries/wallet02"},{kind:"MdxPage",name:"wallet03",route:"/use-cases/WalletQueries/wallet03"},{kind:"MdxPage",name:"wallet04",route:"/use-cases/WalletQueries/wallet04"},{kind:"MdxPage",name:"wallet05",route:"/use-cases/WalletQueries/wallet05"},{kind:"MdxPage",name:"wallet06",route:"/use-cases/WalletQueries/wallet06"},{kind:"MdxPage",name:"wallet07",route:"/use-cases/WalletQueries/wallet07"},{kind:"MdxPage",name:"wallet08",route:"/use-cases/WalletQueries/wallet08"},{kind:"MdxPage",name:"wallet09",route:"/use-cases/WalletQueries/wallet09"},{kind:"MdxPage",name:"wallet10",route:"/use-cases/WalletQueries/wallet10"},{kind:"MdxPage",name:"wallet11",route:"/use-cases/WalletQueries/wallet11"},{kind:"MdxPage",name:"wallet12",route:"/use-cases/WalletQueries/wallet12"}]},{kind:"MdxPage",name:"WalletQueries",route:"/use-cases/WalletQueries"},{kind:"Meta",data:{WalletQueries:"Wallet queries",nftqueries:"NFT marketplace"}},{kind:"Folder",name:"nftqueries",route:"/use-cases/nftqueries",children:[{kind:"Meta",data:{nft1:"View Collections",nft2:"View NFT collection details",nft3:"View all assets",nft4:"Minting an NFT",nft5:"Selling an NFT",nft6:"Buying an NFT"}},{kind:"MdxPage",name:"nft1",route:"/use-cases/nftqueries/nft1"},{kind:"MdxPage",name:"nft2",route:"/use-cases/nftqueries/nft2"},{kind:"MdxPage",name:"nft3",route:"/use-cases/nftqueries/nft3"},{kind:"MdxPage",name:"nft4",route:"/use-cases/nftqueries/nft4"},{kind:"MdxPage",name:"nft5",route:"/use-cases/nftqueries/nft5"},{kind:"MdxPage",name:"nft6",route:"/use-cases/nftqueries/nft6"}]},{kind:"MdxPage",name:"nftqueries",route:"/use-cases/nftqueries"}]},{kind:"MdxPage",name:"use-cases",route:"/use-cases"}],flexsearch:{codeblocks:!0},title:"Wallet03",headings:c},pageNextRoute:"/use-cases/WalletQueries/wallet03",nextraLayout:n.ZP,themeConfig:t.Z};e.default=(0,o.j)(d)},2069:function(s,e,r){"use strict";var l=r(5893);r(7294);let o={logo:(0,l.jsx)("span",{children:(0,l.jsx)("b",{children:"Ledger Sync"})}),project:{link:"https://github.com/cardano-foundation/cf-ledger-sync"},chat:{link:"https://discord.gg/jw3yeYJw"},docsRepositoryBase:"https://github.com/cardano-foundation/cf-ledger-sync",footer:{text:"Ledger Sync project"},useNextSeoProps:()=>({titleTemplate:"%s – Ledger Sync"}),head:(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("meta",{property:"description",content:"Ledger Sync is a Java-based application designed to provide efficient access to Cardano blockchain data"}),(0,l.jsx)("meta",{property:"og:title",content:"Ledger Sync is a Java-based application designed to provide efficient access to Cardano blockchain data"}),(0,l.jsx)("meta",{property:"og:description",content:"Ledger Sync is a Java-based application designed to provide efficient access to Cardano blockchain data"})]})};e.Z=o},5789:function(){}},function(s){s.O(0,[942,888,774,179],function(){return s(s.s=9728)}),_N_E=s.O()}]);