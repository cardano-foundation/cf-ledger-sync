(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[643],{287:function(e,s,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/use-cases/nftqueries/nft5",function(){return t(6474)}])},6474:function(e,s,t){"use strict";t.r(s),t.d(s,{__toc:function(){return c}});var n=t(5893),a=t(2673),r=t(2169),l=t(2069);t(9488);var i=t(2643),o=t(2154);let c=[{depth:2,value:"5. Selling an NFT",id:"5-selling-an-nft"}];function d(e){let s=Object.assign({h2:"h2",p:"p",a:"a",ul:"ul",li:"li",strong:"strong",ol:"ol",code:"code",pre:"pre",span:"span",details:"details",summary:"summary"},(0,i.a)(),e.components);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(s.h2,{id:"5-selling-an-nft",children:"5. Selling an NFT"}),"\n",(0,n.jsx)(s.p,{children:'Selling, or listing, an NFT on a marketplace (often referred to as creating an "ask", where you offer assets in exchange for ADA) involves utilizing smart contracts. These contracts facilitate secure agreements between parties who may not necessarily trust each other.'}),"\n",(0,n.jsxs)(s.p,{children:["For this exercise, we'll assume you're already familiar with the concept of smart contracts and understand how they operate. If not, consider reviewing resources such as the ",(0,n.jsx)(s.a,{href:"https://developers.cardano.org/docs/smart-contracts/",children:"Cardano Developer Portal"})," and the Aiken ",(0,n.jsx)(s.a,{href:"https://aiken-lang.org/fundamentals/eutxo",children:"EUTxO crash course"})," to name but a few."]}),"\n",(0,n.jsxs)(s.p,{children:["The first step in listing an NFT for sale is to create the necessary smart contracts. An example of such a contract can be found in the GitHub repositories of ",(0,n.jsx)(s.a,{href:"https://github.com/jpg-store/",children:"JPG.Store"}),"."]}),"\n",(0,n.jsx)(s.p,{children:"In our example, we will use the smart contract components for the following information:"}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsxs)(s.li,{children:["\n",(0,n.jsxs)(s.p,{children:[(0,n.jsx)(s.strong,{children:"Datum"}),": Contains information such as the owner's public key hash (pkh), the assets being sold, and payout details (e.g., asset cost, artist royalties, marketplace service fees)."]}),"\n"]}),"\n",(0,n.jsxs)(s.li,{children:["\n",(0,n.jsxs)(s.p,{children:[(0,n.jsx)(s.strong,{children:"Redeemer"}),": Specifies what actions a user can take with the locked asset, such as “listing”,  “buying or accept“, “canceling”, or “update listing”."]}),"\n"]}),"\n",(0,n.jsxs)(s.li,{children:["\n",(0,n.jsxs)(s.p,{children:[(0,n.jsx)(s.strong,{children:"Validator"}),": It ensures that the signer is the rightful owner, that payouts are correctly configured, and that the appropriate redeemer tag is present so transaction can be successfully processed."]}),"\n"]}),"\n"]}),"\n",(0,n.jsxs)(s.p,{children:["These are on-chain components, where datum and redeemer information are stored  in the Ledger Sync database in CBOR and JSON format in the following tables: ",(0,n.jsx)(s.a,{href:"https://github.com/cardano-foundation/cf-ledger-sync/blob/main/docs/pages/schema.md#datum",children:"datum"}),", ",(0,n.jsx)(s.a,{href:"https://github.com/cardano-foundation/cf-ledger-sync/blob/main/docs/pages/schema.md#redeemer_data",children:"redeemer_data"}),", and also  referenced on ",(0,n.jsx)(s.a,{href:"https://github.com/cardano-foundation/cf-ledger-sync/blob/main/docs/pages/schema.md#tx_out",children:"tx_out"})," and ",(0,n.jsx)(s.a,{href:"https://github.com/cardano-foundation/cf-ledger-sync/blob/main/docs/pages/schema.md#failed_tx_out",children:"failed_tx_out"}),"."]}),"\n",(0,n.jsx)(o.UW,{type:"info",emoji:"ℹ️",children:(0,n.jsxs)(s.p,{children:["Note: In case if you would like to decode the Datum, you can use ",(0,n.jsx)(s.a,{href:"https://cardanoscan.io/datumInspector",children:"Datum Inspector - Cardanoscan"})]})}),"\n",(0,n.jsx)(s.p,{children:"Before proceeding, ensure that you have created the script address for user to interact with the smart contract."}),"\n",(0,n.jsxs)(s.p,{children:["At this stage, you probably have already implemented wallet connection functionality (e.g., via ",(0,n.jsx)(s.a,{href:"https://cips.cardano.org/cip/CIP-30",children:"CIP-30"})," or in another way), allowing your application to interact with users' wallets."]}),"\n",(0,n.jsx)(s.p,{children:'On the Marketplace application, when a user clicks on "Sell", the application backend will build a transaction that matches the requirements of the smart contract. This includes:'}),"\n",(0,n.jsxs)(s.ol,{children:["\n",(0,n.jsxs)(s.li,{children:["\n",(0,n.jsx)(s.p,{children:"Setting the datum with details like the owner of the public key hash, the asset being sold, and all required payouts: asset cost, royalties for the artist, and marketplace service fees. This information is necessary to lock the NFT in the smart contract address, making sure that all requirements are met (based on the smart contract created)."}),"\n"]}),"\n",(0,n.jsxs)(s.li,{children:["\n",(0,n.jsx)(s.p,{children:"Including the redeemer code, in our example “listing”"}),"\n"]}),"\n",(0,n.jsxs)(s.li,{children:["\n",(0,n.jsx)(s.p,{children:"Providing the necessary transaction UTXOs and address inputs and outputs."}),"\n"]}),"\n"]}),"\n",(0,n.jsx)(s.p,{children:"To successfully build the transaction, you'll need the following data, typically stored in the Ledger Sync database:"}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.strong,{children:"Protocol Parameters"}),": Define blockchain settings necessary for calculating transaction fees and other critical parameters."]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.strong,{children:"UTXOs"}),": The Unspent Transaction Outputs associated with the wallet that will fund the transaction."]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.strong,{children:"Slot/Block Tip"}),": The current slot or block tip to ensure the transaction is valid within the blockchain context."]}),"\n"]}),"\n",(0,n.jsx)(s.p,{children:"Once the required data is gathered, the transaction can be built, signed through the user's wallet, and submitted on-chain. After submission, the validator (code running on-chain) will confirm that all conditions are met, and if so, the NFT will be transferred and locked at the smart contract address."}),"\n",(0,n.jsx)(s.p,{children:"Then, to view assets currently for sale on your marketplace, simply query the smart contract address created for the marketplace."}),"\n",(0,n.jsxs)(s.p,{children:["For example, you can check all assets on listings on the JPG.Store marketplace by visiting ",(0,n.jsx)(s.a,{href:"https://cardanoscan.io/address/addr1x8rjw3pawl0kelu4mj3c8x20fsczf5pl744s9mxz9v8n7efvjel5h55fgjcxgchp830r7h2l5msrlpt8262r3nvr8ekstg4qrx",children:"this address"})," on a Cardano Explorer."]}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.strong,{children:"Sources:"})}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsx)(s.li,{children:(0,n.jsx)(s.a,{href:"https://github.com/jpg-store/contract-v2",children:"JPG.Store Contract V2"})}),"\n",(0,n.jsx)(s.li,{children:(0,n.jsx)(s.a,{href:"https://github.com/jpg-store/contracts-v3/blob/main/validators/ask.ak",children:"JPG.Store Contract V3"})}),"\n",(0,n.jsx)(s.li,{children:(0,n.jsx)(s.a,{href:"https://medium.com/@jpgstorenft/unveiling-the-next-gen-smart-contract-update-for-jpg-store-2f883c913979",children:"JPG.Store Next-Gen Smart Contract Update"})}),"\n"]}),"\n",(0,n.jsx)(s.p,{children:"In previous queries, we've already retrieved:"}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsx)(s.li,{children:"Protocol parameters"}),"\n",(0,n.jsx)(s.li,{children:"UTXOs associated to the address below"}),"\n",(0,n.jsx)(s.li,{children:"Chain Tip"}),"\n"]}),"\n",(0,n.jsx)(s.p,{children:"Now we will retrieve all assets locked on a contract address and their respective:"}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsx)(s.li,{children:"Asset Name"}),"\n",(0,n.jsx)(s.li,{children:"Asset policy ID"}),"\n",(0,n.jsx)(s.li,{children:"Asset Fingerprint"}),"\n",(0,n.jsx)(s.li,{children:"Amount"}),"\n"]}),"\n",(0,n.jsxs)(s.p,{children:["We will query this address ",(0,n.jsx)(s.code,{children:"addr1x8rjw3pawl0kelu4mj3c8x20fsczf5pl744s9mxz9v8n7efvjel5h55fgjcxgchp830r7h2l5msrlpt8262r3nvr8ekstg4qrx"})]}),"\n",(0,n.jsx)(s.pre,{"data-language":"sql","data-theme":"default",children:(0,n.jsxs)(s.code,{"data-language":"sql","data-theme":"default",children:[(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"SELECT"})}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"		    ma.policy "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"AS"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"policy"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:","})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"		    ma.name "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"AS"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"name"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:","})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"		    ma.fingerprint "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"AS"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" fingerprint,"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"		    "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"sum"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"(mto.quantity) "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"AS"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" quantity"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"		"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"FROM"})]}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"		    ma_tx_out mto"})}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"		"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"JOIN"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" multi_asset ma "})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"			"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"ON"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" ma.id "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" mto.ident "})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"		"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"JOIN"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" tx_out "})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"			"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"ON"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" mto.tx_out_id "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" tx_out.id"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"		"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"LEFT JOIN"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" tx_in ti "})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"			"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"ON"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" ti.tx_out_id "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" tx_out.tx_id "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"AND"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" ti.tx_out_index "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" tx_out."}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"index"'})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"		"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"WHERE"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"		    tx_out.address "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'addr1x8rjw3pawl0kelu4mj3c8x20fsczf5pl744s9mxz9v8n7efvjel5h55fgjcxgchp830r7h2l5msrlpt8262r3nvr8ekstg4qrx'"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"		    "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"AND"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" ti.tx_out_id "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"is"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"null"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"		"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"GROUP BY"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" ma.policy, ma.name, ma.fingerprint"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"		"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"ORDER BY"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" quantity "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"DESC"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"		"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"LIMIT"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"10"})]})]})}),"\n",(0,n.jsxs)(s.details,{children:[(0,n.jsx)(s.summary,{children:(0,n.jsx)(s.p,{children:"Expected results format"})}),(0,n.jsx)(s.pre,{"data-language":"sql","data-theme":"default",children:(0,n.jsxs)(s.code,{"data-language":"sql","data-theme":"default",children:[(0,n.jsx)(s.span,{className:"line",children:" "}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"policy"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"	    			                        		 | "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"name"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"                     | fingerprint    		                   	   | quantity"})]}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"---------------------------------------------------------+--------------------------+----------------------------------------------+--------------"})}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"64c11b97a1bc395f5cd3a6f2f594292510ae483af77151d1d6136edc | 	SNEKWRANGLER 	    	| asset13vuukdg8klkf6px6zt6jq2rqzs0l3gyvjyzhql | "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"4"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:","}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"500"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:","}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"000"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:","}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"000"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"52225d8259c95ec7d1727c8a591398846718eaa8fae533a1b8d2b9d6 | 	EL		    			| asset1flkp5ddlknrdakpw72hmxwkkp0qkfuhlzzn5gw | "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"1"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:","}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"000"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:","}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"000"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:","}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"000"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"1da3b63de574c7a103de734d8b1215b5ff5e3863d9fdecff8e09810c | 	FAM	         			| asset1rs7t52lrfxrpz9p8f8egtwdlx4d33mqk62pyuu | "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"439"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:","}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"678"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:","}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"272"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"ad5281e310da442d8d00ef3f7809cd0a1c035cf5039c0d90f236b7bc | 	FAM   		    		| asset1x77jxgfrnn00650gsdtxpuea3k2a6xslaf6key | "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"439"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:","}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"000"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:","}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"000"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"daf494081cbb6872c6303d04697e5d10d4db8a69e4229beda69dd0af | 	CRAZYMARY	    		| asset1uxza25kph43w2w6mstuspzmy47rvu4ks898q72 | "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"250"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:","}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"000"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:","}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"000"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"577f0b1342f8f8f4aed3388b80a8535812950c7a892495c0ecdf0f1e | \\u0000\\u0014�\\u0010FLDT  | asset1gayaljphz3tepway6u6ruuty9cee2pj7wch408 | "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"180"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:","}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"000"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:","}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"000"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"05e1f8298560c85f03248a7b3e5322f12e27e4cdc1378a4f3bc51083 | 	ReebokaHoskinson    	| asset18efh7djgsyat7m8j43etsusxhkv94940adss5k | "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"150"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:","}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"000"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:","}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"000"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"efa0e694d5915f52b00a0d01135efdb85a0bdde7009bbcf68ea12a3d | 	TV	            		| asset1lr06zsp4qzxv2emchq2j2mfwhqxzgtmxywrrvn | "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"50"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:","}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"000"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:","}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"000"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"e79497f972acb83461608d3f48281a406ee1e9f64ed168868145141e | 	StakePool247        	| asset1946tqd3qe3hq3mxtzg4gkxqupnys0v9tr8v0zt | "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"25"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:","}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"000"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:","}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"000"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"15452b831185cdc3a18d27fea3fd30c9f765349352e523725c02b8f0 | 	SWS		    			| asset1968r7exh3296rls9axexyhqu3lk2c23mn5zjhz | "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"16"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:","}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"900"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:","}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"000"})]}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"           "})})]})})]}),"\n",(0,n.jsx)(o.UW,{type:"info",emoji:"ℹ️",children:(0,n.jsx)(s.p,{children:"Note that some results may display differently in some explorers compared to Ledger Sync results. This is because the 'decimal' parameter of each token may be set differently so a query may return the full data without dividing by decimal, while others divide by a decimal. This parameter is stored in the metadata registry. For the Ledger Sync database, the parameter is set to display the full data."})}),"\n",(0,n.jsx)(s.p,{children:"\uD83D\uDD0E Looking closer, this query retrieves the top 10 native assets held by our specific address."}),"\n",(0,n.jsxs)(s.p,{children:[(0,n.jsx)(s.code,{children:"SELECT ma.policy, ma.name, ma.fingerprint, sum(mto.quantity) AS quantity"})," specifies the columns to be retrieved:"]}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.code,{children:"ma.policy"})," is the policy ID associated with the asset."]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.code,{children:"ma.name"})," is the name of the asset."]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.code,{children:"ma.fingerprint"})," is the unique fingerprint of the asset."]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.code,{children:"sum(mto.quantity) AS quantity"})," calculates the total quantity of each asset held by the address."]}),"\n"]}),"\n",(0,n.jsxs)(s.p,{children:[(0,n.jsx)(s.code,{children:"FROM ma_tx_out mto"})," selects data from the ",(0,n.jsx)(s.a,{href:"https://github.com/cardano-foundation/cf-ledger-sync/blob/main/docs/pages/schema.md#ma_tx_out",children:"ma_tx_out"})," table, which stores information about asset transaction outputs."]}),"\n",(0,n.jsxs)(s.p,{children:[(0,n.jsx)(s.code,{children:"JOIN multi_asset ma ON ma.id = mto.ident"})," joins the ",(0,n.jsx)(s.a,{href:"https://github.com/cardano-foundation/cf-ledger-sync/blob/main/docs/pages/schema.md#ma_tx_out",children:"ma_tx_out"})," table with the multi_asset table based on matching ",(0,n.jsx)(s.code,{children:"id"})," and ",(0,n.jsx)(s.code,{children:"ident"})," values. This links the transaction output information with the details of the asset itself."]}),"\n",(0,n.jsxs)(s.p,{children:[(0,n.jsx)(s.code,{children:"JOIN tx_out ON mto.tx_out_id = tx_out.id"})," joins the result with the ",(0,n.jsx)(s.a,{href:"https://github.com/cardano-foundation/cf-ledger-sync/blob/main/docs/pages/schema.md#tx_out",children:"tx_out"})," table to get the transaction output details associated with the asset outputs."]}),"\n",(0,n.jsxs)(s.p,{children:[(0,n.jsx)(s.code,{children:'LEFT JOIN tx_in ti ON ti.tx_out_id = tx_out.tx_id AND ti.tx_out_index = tx_out."index"'})," performs a left join with the ",(0,n.jsx)(s.a,{href:"https://github.com/cardano-foundation/cf-ledger-sync/blob/main/docs/pages/schema.md#tx_in",children:"tx_in"})," table to identify which transaction outputs have been spent (used as inputs in other transactions)."]}),"\n",(0,n.jsxs)(s.p,{children:[(0,n.jsx)(s.code,{children:"WHERE tx_out.address = 'addr1x8rjw3pawl0kelu4mj3c8x20fsczf5pl744s9mxz9v8n7efvjel5h55fgjcxgchp830r7h2l5msrlpt8262r3nvr8ekstg4qrx' AND ti.tx_out_id is null"})," filters the results to only include:"]}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsx)(s.li,{children:"Transaction outputs belonging to the specified  address."}),"\n",(0,n.jsxs)(s.li,{children:["Transaction outputs that have not been spent (i.e., ",(0,n.jsx)(s.code,{children:"ti.tx_out_id"})," is null). This ensures we're only looking at the unspent assets (the ones the address currently holds)."]}),"\n"]}),"\n",(0,n.jsxs)(s.p,{children:[(0,n.jsx)(s.code,{children:"GROUP BY ma.policy, ma.name, ma.fingerprint"})," groups the results by the policy, name, and fingerprint of the asset, allowing us to calculate the total quantity of each unique asset held."]}),"\n",(0,n.jsxs)(s.p,{children:[(0,n.jsx)(s.code,{children:"ORDER BY quantity DESC"})," sorts the results in descending order based on the calculated quantity. This puts the assets with the highest quantities at the top."]}),"\n",(0,n.jsxs)(s.p,{children:[(0,n.jsx)(s.code,{children:"LIMIT 10"})," limits the output to the top 10 results."]})]})}let h={MDXContent:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:s}=Object.assign({},(0,i.a)(),e.components);return s?(0,n.jsx)(s,{...e,children:(0,n.jsx)(d,{...e})}):d(e)},pageOpts:{filePath:"pages/use-cases/nftqueries/nft5.mdx",route:"/use-cases/nftqueries/nft5",timestamp:1729499085e3,pageMap:[{kind:"Meta",data:{index:"Overview",design:"Design",docker:"Run with Docker Compose",schema:"Schema",build_run:"Build & Run",live_n2c_data:"Live data from Node",applications:{title:"Applications"},"use-cases":{title:"Use Cases"},about:{title:"About",type:"page"}}},{kind:"MdxPage",name:"about",route:"/about"},{kind:"Folder",name:"applications",route:"/applications",children:[{kind:"Meta",data:{ledger_sync_app:"Ledger Sync",streamer_app:"Ledger Sync Streamer"}},{kind:"MdxPage",name:"ledger_sync_app",route:"/applications/ledger_sync_app"},{kind:"MdxPage",name:"streamer_app",route:"/applications/streamer_app"}]},{kind:"MdxPage",name:"build_run",route:"/build_run"},{kind:"MdxPage",name:"design",route:"/design"},{kind:"MdxPage",name:"docker",route:"/docker"},{kind:"MdxPage",name:"index",route:"/"},{kind:"MdxPage",name:"live_n2c_data",route:"/live_n2c_data"},{kind:"MdxPage",name:"schema",route:"/schema"},{kind:"Folder",name:"use-cases",route:"/use-cases",children:[{kind:"Folder",name:"WalletQueries",route:"/use-cases/WalletQueries",children:[{kind:"Meta",data:{wallet01:"Find the ADA balance of a wallet",wallet02:"List a balance's UTXOs",wallet03:"Review wallet transaction history",wallet04:"List all tokens in a wallet",wallet05:"Query collection details",wallet06:"Query Token metadata",wallet07:"Query Active Stake Pools",wallet08:"Query Stake Pool details",wallet09:"Stake pool lifetime blocks",wallet10:"List current dReps",wallet11:"Find Active Governance Proposals",wallet12:"Smart contract transaction data"}},{kind:"MdxPage",name:"wallet01",route:"/use-cases/WalletQueries/wallet01"},{kind:"MdxPage",name:"wallet02",route:"/use-cases/WalletQueries/wallet02"},{kind:"MdxPage",name:"wallet03",route:"/use-cases/WalletQueries/wallet03"},{kind:"MdxPage",name:"wallet04",route:"/use-cases/WalletQueries/wallet04"},{kind:"MdxPage",name:"wallet05",route:"/use-cases/WalletQueries/wallet05"},{kind:"MdxPage",name:"wallet06",route:"/use-cases/WalletQueries/wallet06"},{kind:"MdxPage",name:"wallet07",route:"/use-cases/WalletQueries/wallet07"},{kind:"MdxPage",name:"wallet08",route:"/use-cases/WalletQueries/wallet08"},{kind:"MdxPage",name:"wallet09",route:"/use-cases/WalletQueries/wallet09"},{kind:"MdxPage",name:"wallet10",route:"/use-cases/WalletQueries/wallet10"},{kind:"MdxPage",name:"wallet11",route:"/use-cases/WalletQueries/wallet11"},{kind:"MdxPage",name:"wallet12",route:"/use-cases/WalletQueries/wallet12"}]},{kind:"MdxPage",name:"WalletQueries",route:"/use-cases/WalletQueries"},{kind:"Meta",data:{WalletQueries:"Wallet queries",nftqueries:"NFT marketplace"}},{kind:"Folder",name:"nftqueries",route:"/use-cases/nftqueries",children:[{kind:"Meta",data:{nft1:"View Collections",nft2:"View NFT collection details",nft3:"View all assets",nft4:"Minting an NFT",nft5:"Selling an NFT",nft6:"Buying an NFT"}},{kind:"MdxPage",name:"nft1",route:"/use-cases/nftqueries/nft1"},{kind:"MdxPage",name:"nft2",route:"/use-cases/nftqueries/nft2"},{kind:"MdxPage",name:"nft3",route:"/use-cases/nftqueries/nft3"},{kind:"MdxPage",name:"nft4",route:"/use-cases/nftqueries/nft4"},{kind:"MdxPage",name:"nft5",route:"/use-cases/nftqueries/nft5"},{kind:"MdxPage",name:"nft6",route:"/use-cases/nftqueries/nft6"}]},{kind:"MdxPage",name:"nftqueries",route:"/use-cases/nftqueries"}]},{kind:"MdxPage",name:"use-cases",route:"/use-cases"}],flexsearch:{codeblocks:!0},title:"Nft5",headings:c},pageNextRoute:"/use-cases/nftqueries/nft5",nextraLayout:r.ZP,themeConfig:l.Z};s.default=(0,a.j)(h)},2069:function(e,s,t){"use strict";var n=t(5893);t(7294);let a={logo:(0,n.jsx)("span",{children:(0,n.jsx)("b",{children:"Ledger Sync"})}),project:{link:"https://github.com/cardano-foundation/cf-ledger-sync"},chat:{link:"https://discord.gg/jw3yeYJw"},docsRepositoryBase:"https://github.com/cardano-foundation/cf-ledger-sync",footer:{text:"Ledger Sync project"},useNextSeoProps:()=>({titleTemplate:"%s – Ledger Sync"}),head:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("meta",{property:"description",content:"Ledger Sync is a Java-based application designed to provide efficient access to Cardano blockchain data"}),(0,n.jsx)("meta",{property:"og:title",content:"Ledger Sync is a Java-based application designed to provide efficient access to Cardano blockchain data"}),(0,n.jsx)("meta",{property:"og:description",content:"Ledger Sync is a Java-based application designed to provide efficient access to Cardano blockchain data"})]})};s.Z=a},5789:function(){}},function(e){e.O(0,[942,888,774,179],function(){return e(e.s=287)}),_N_E=e.O()}]);