package org.cardanofoundation.ledgersync.explorerconsumer.hash;

import com.bloxbean.cardano.client.crypto.Blake2bUtil;
import com.bloxbean.cardano.client.util.HexUtil;

import org.junit.jupiter.api.Test;

import static org.junit.jupiter.api.Assertions.assertEquals;

class DatumTest {

  @Test
  void hashCbor() {
    String cbor = "a54a63757272656e63696573a246736f75726365581c68747470733a2f2f6e6f746e756c6c736f6c7574696f6e732e636f6d4773796d626f6c739fa4457363616c651a000186a04673796d626f6c4345555244756e6974474555522f5553444576616c75651a00014adca4457363616c651a000186a04673796d626f6c4347425044756e6974474742502f5553444576616c75651a00011c15a4457363616c6518644673796d626f6c4349445244756e6974474944522f5553444576616c75651a0015b625ff466d6574616c73a246736f75726365581c68747470733a2f2f6e6f746e756c6c736f6c7574696f6e732e636f6d4773796d626f6c739fa4457363616c6518644673796d626f6c42417544756e6974495553442f6f756e63654576616c75651a0002c528a4457363616c6518644673796d626f6c42416744756e6974495553442f6f756e63654576616c756519095ca4457363616c65014673796d626f6c42507444756e6974495553442f6f756e63654576616c7565190400a4457363616c65014673796d626f6c42506444756e6974495553442f6f756e63654576616c75651909b3ff4773657276696365581c68747470733a2f2f6f7261636c652e70696779746f6b656e2e636f6d44736f6672a246736f75726365583768747470733a2f2f7777772e6e6577796f726b6665642e6f72672f6d61726b6574732f7265666572656e63652d72617465732f736f66724773796d626f6c739fa4457363616c6518644673796d626f6c44534f465244756e697441254576616c756505ff4974696d657374616d705819323032312d30382d33315431373a30363a31352b30303a3030";
    var bytes = HexUtil.decodeHexString(cbor);
    String hashDatum = HexUtil.encodeHexString(Blake2bUtil.blake2bHash256(bytes));
    assertEquals("5865d96e4313780a37af26055cdcc90308db23adaf4f2082178355e5e1dc20f6", hashDatum);
  }

}
